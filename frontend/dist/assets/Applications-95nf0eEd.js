import{r as p,a as K,A as L,c as O,b as t,w as l,d as n,B as D,E as k,C as Q,o as v,D as W,k as f,g as s,y as d,l as C,h as X}from"./index-BwUFaNKW.js";const Y={class:"applications"},ee={__name:"Applications",setup(Z){const g=p(!1),x=p([]),b=p(1),y=p(10),z=p(0),V=p(!1),_=p(!1),u=p(null),i=K({status:"approved",review_comment:""});function N(o){return{pending:"warning",approved:"success",rejected:"danger"}[o]||"info"}function S(o){return{pending:"待审核",approved:"已通过",rejected:"已拒绝"}[o]||o}async function w(){g.value=!0;try{const o=await D.get("/applications",{params:{page:b.value,per_page:y.value}});o.data.success&&(x.value=o.data.data.items,z.value=o.data.data.total)}catch{k.error("获取申请列表失败")}finally{g.value=!1}}function E(o){u.value=o,V.value=!0}function U(o,e){u.value=o,i.status=e,i.review_comment="",_.value=!0}async function T(){try{await D.post(`/applications/${u.value.id}/review`,i),k.success("审核成功"),_.value=!1,w()}catch{k.error("审核失败")}}return L(()=>{w()}),(o,e)=>{const r=n("el-table-column"),M=n("el-tag"),c=n("el-button"),P=n("el-table"),R=n("el-pagination"),F=n("el-card"),m=n("el-descriptions-item"),q=n("el-descriptions"),B=n("el-dialog"),$=n("el-radio"),G=n("el-radio-group"),j=n("el-form-item"),H=n("el-input"),I=n("el-form"),J=Q("loading");return v(),O("div",Y,[t(F,null,{header:l(()=>[...e[7]||(e[7]=[X("span",null,"申请管理",-1)])]),default:l(()=>[W((v(),f(P,{data:x.value,border:""},{default:l(()=>[t(r,{prop:"student_name",label:"学生姓名"}),t(r,{prop:"student_id_number",label:"学号"}),t(r,{prop:"position_title",label:"岗位标题"}),t(r,{prop:"position_company",label:"公司名称"}),t(r,{prop:"status",label:"状态"},{default:l(({row:a})=>[t(M,{type:N(a.status)},{default:l(()=>[s(d(S(a.status)),1)]),_:2},1032,["type"])]),_:1}),t(r,{prop:"created_at",label:"申请时间"}),t(r,{label:"操作",width:"200"},{default:l(({row:a})=>[a.status==="pending"?(v(),f(c,{key:0,size:"small",type:"success",onClick:A=>U(a,"approved")},{default:l(()=>[...e[8]||(e[8]=[s(" 通过 ",-1)])]),_:1},8,["onClick"])):C("",!0),a.status==="pending"?(v(),f(c,{key:1,size:"small",type:"danger",onClick:A=>U(a,"rejected")},{default:l(()=>[...e[9]||(e[9]=[s(" 拒绝 ",-1)])]),_:1},8,["onClick"])):C("",!0),t(c,{size:"small",onClick:A=>E(a)},{default:l(()=>[...e[10]||(e[10]=[s("查看",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[J,g.value]]),t(R,{"current-page":b.value,"onUpdate:currentPage":e[0]||(e[0]=a=>b.value=a),"page-size":y.value,"onUpdate:pageSize":e[1]||(e[1]=a=>y.value=a),total:z.value,layout:"total, prev, pager, next",onCurrentChange:w,style:{"margin-top":"20px"}},null,8,["current-page","page-size","total"])]),_:1}),t(B,{modelValue:V.value,"onUpdate:modelValue":e[2]||(e[2]=a=>V.value=a),title:"申请详情",width:"600px"},{default:l(()=>[u.value?(v(),f(q,{key:0,column:2,border:""},{default:l(()=>[t(m,{label:"学生姓名"},{default:l(()=>[s(d(u.value.student_name),1)]),_:1}),t(m,{label:"学号"},{default:l(()=>[s(d(u.value.student_id_number),1)]),_:1}),t(m,{label:"岗位标题"},{default:l(()=>[s(d(u.value.position_title),1)]),_:1}),t(m,{label:"公司名称"},{default:l(()=>[s(d(u.value.position_company),1)]),_:1}),t(m,{label:"申请动机",span:2},{default:l(()=>[s(d(u.value.motivation),1)]),_:1}),t(m,{label:"简历",span:2},{default:l(()=>[s(d(u.value.resume),1)]),_:1})]),_:1})):C("",!0)]),_:1},8,["modelValue"]),t(B,{modelValue:_.value,"onUpdate:modelValue":e[6]||(e[6]=a=>_.value=a),title:"审核申请",width:"500px"},{footer:l(()=>[t(c,{onClick:e[5]||(e[5]=a=>_.value=!1)},{default:l(()=>[...e[13]||(e[13]=[s("取消",-1)])]),_:1}),t(c,{type:"primary",onClick:T},{default:l(()=>[...e[14]||(e[14]=[s("确定",-1)])]),_:1})]),default:l(()=>[t(I,{model:i,"label-width":"100px"},{default:l(()=>[t(j,{label:"审核结果"},{default:l(()=>[t(G,{modelValue:i.status,"onUpdate:modelValue":e[3]||(e[3]=a=>i.status=a)},{default:l(()=>[t($,{label:"approved"},{default:l(()=>[...e[11]||(e[11]=[s("通过",-1)])]),_:1}),t($,{label:"rejected"},{default:l(()=>[...e[12]||(e[12]=[s("拒绝",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(j,{label:"审核意见"},{default:l(()=>[t(H,{modelValue:i.review_comment,"onUpdate:modelValue":e[4]||(e[4]=a=>i.review_comment=a),type:"textarea",rows:4},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}};export{ee as default};
